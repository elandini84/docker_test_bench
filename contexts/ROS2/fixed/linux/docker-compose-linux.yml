version: "3.7"
services:
# Image
  landocker:
    image: landocker/win10
    build:
      context: .
      network: host
      dockerfile: Dockerfile
  nav-ros2-server:
    image: landocker/win10
    container_name: nav-ros2-server
    environment:
    - YARP_COLORED_OUTPUT=1
    - YARP_FORWARD_LOG_ENABLE=1
    - YARP_FORWARD_CODEINFO_ENABLE=1
    command: yarpserver
    network_mode: host
    ipc: host
  nav-ros2-host:
    image: landocker/win10
    container_name: nav-ros2-host
    environment:
    - DISPLAY=host.docker.internal:0
    - YARP_COLORED_OUTPUT=1
    - YARP_FORWARD_LOG_ENABLE=1
    - YARP_FORWARD_CODEINFO_ENABLE=1
    - QT_X11_NO_MITSHM=1
    - LIBGL_ALWAYS_INDIRECT=0
    volumes:
      - "/tmp/.X11-unix:/tmp/.X11-unix:rw"
      - "${XAUTHORITY}/:/home/user1/.Xauthority:rw"
      - "C:/ExchangeData:/home/user1/ex_data_mount"
      - "C:/Projects/Stuff:/home/user1/ex_stuff"
      - "C:/Projects/GIT/:/home/user1/mntCode"
    command: sh -c "yarp detect --write && yarp run --server /console --log"
    network_mode: host
    ipc: host
    depends_on:
      - nav-ros2-server
